<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>ConFLiCT: Serialport.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ConFLiCT
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Serialport.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Serialport communication via RS232.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;avr/io.h&gt;</code><br/>
<code>#include &lt;avr/interrupt.h&gt;</code><br/>
<code>#include &lt;stdbool.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="_serialport_8h_source.html">Serialport.h</a>&quot;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7d2ad1b66db9224eff7468cbafe4f9d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_serialport_8c.html#a7d2ad1b66db9224eff7468cbafe4f9d0">serialport_write</a> (uint8_t *anArray, uint8_t arrayLength)</td></tr>
<tr class="memdesc:a7d2ad1b66db9224eff7468cbafe4f9d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function you send an array (string).  <a href="#a7d2ad1b66db9224eff7468cbafe4f9d0">More...</a><br/></td></tr>
<tr class="separator:a7d2ad1b66db9224eff7468cbafe4f9d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdf978f69a52b8a2225b0536b5fbff0e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acdf978f69a52b8a2225b0536b5fbff0e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ISR</b> (USARTC1_DRE_vect)</td></tr>
<tr class="separator:acdf978f69a52b8a2225b0536b5fbff0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48f486016e00b1593a7098dc9df8dbb5"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_serialport_8c.html#a48f486016e00b1593a7098dc9df8dbb5">serialport_checkSpace</a> (void)</td></tr>
<tr class="memdesc:a48f486016e00b1593a7098dc9df8dbb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function check how many bytes are free in the transmit buffer.  <a href="#a48f486016e00b1593a7098dc9df8dbb5">More...</a><br/></td></tr>
<tr class="separator:a48f486016e00b1593a7098dc9df8dbb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c9949e5146d1feb028b0c2db8754523"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6c9949e5146d1feb028b0c2db8754523"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ISR</b> (USARTC1_RXC_vect)</td></tr>
<tr class="separator:a6c9949e5146d1feb028b0c2db8754523"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a6fdcfe4ee9f9044edfc40f9968e25a"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_serialport_8c.html#a4a6fdcfe4ee9f9044edfc40f9968e25a">serialport_getLastString</a> (uint8_t *anArray, uint8_t maxLength)</td></tr>
<tr class="memdesc:a4a6fdcfe4ee9f9044edfc40f9968e25a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function gives you all received data to the next CR (carriage return) in string format.  <a href="#a4a6fdcfe4ee9f9044edfc40f9968e25a">More...</a><br/></td></tr>
<tr class="separator:a4a6fdcfe4ee9f9044edfc40f9968e25a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af386d3688b5e9b9ab460e6caf736a299"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af386d3688b5e9b9ab460e6caf736a299"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_serialport_8c.html#af386d3688b5e9b9ab460e6caf736a299">serialport_init</a> (void)</td></tr>
<tr class="memdesc:af386d3688b5e9b9ab460e6caf736a299"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes the USART C1 to 8N1 with 57600 Baud and enables the RXC interrupt. <br/></td></tr>
<tr class="separator:af386d3688b5e9b9ab460e6caf736a299"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af6c0452c6622b4cae3258d822c44ee"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_serialport_8c.html#a0af6c0452c6622b4cae3258d822c44ee">serialport_getLastCarriage</a> (<a class="el" href="struct_c_a_r_r_i_a_g_e.html">CARRIAGE</a> *aCARRIAGE)</td></tr>
<tr class="memdesc:a0af6c0452c6622b4cae3258d822c44ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function gives you the last received carriage.  <a href="#a0af6c0452c6622b4cae3258d822c44ee">More...</a><br/></td></tr>
<tr class="separator:a0af6c0452c6622b4cae3258d822c44ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae032fbb13c4f1a7ecc1239dbf40f9258"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_serialport_8c.html#ae032fbb13c4f1a7ecc1239dbf40f9258">serialport_writeCarriage</a> (<a class="el" href="struct_c_a_r_r_i_a_g_e.html">CARRIAGE</a> *aCARRIAGE)</td></tr>
<tr class="memdesc:ae032fbb13c4f1a7ecc1239dbf40f9258"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function send a carriage as string in the carriage format.  <a href="#ae032fbb13c4f1a7ecc1239dbf40f9258">More...</a><br/></td></tr>
<tr class="separator:ae032fbb13c4f1a7ecc1239dbf40f9258"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Serialport communication via RS232. </p>
<p>This library contains functions to communicate with the PC via RS232.<br/>
 </p>
<dl class="section author"><dt>Author</dt><dd>Robert Steigemann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>14 Oct 2013 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a48f486016e00b1593a7098dc9df8dbb5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t serialport_checkSpace </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function check how many bytes are free in the transmit buffer. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of free bytes in the transmit buffer. </dd></dl>

</div>
</div>
<a class="anchor" id="a0af6c0452c6622b4cae3258d822c44ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t serialport_getLastCarriage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_a_r_r_i_a_g_e.html">CARRIAGE</a> *&#160;</td>
          <td class="paramname"><em>aCARRIAGE</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function gives you the last received carriage. </p>
<p>This function read out the last received string (witch should have the carriage format) and convert it to a carriage. It is protected against wrong string codes. The function use the <a class="el" href="_serialport_8c.html#a4a6fdcfe4ee9f9044edfc40f9968e25a" title="This function gives you all received data to the next CR (carriage return) in string format...">serialport_getLastString()</a> function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aCARRIAGE</td><td>The pointer to the carriage witch is assigned with the new data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- 0 everything fine, carriage received<ul>
<li>1 no CR is received until the last execution (no new data available)</li>
<li>&gt;1 something is received, but isn't valid (details in implementation) </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="a4a6fdcfe4ee9f9044edfc40f9968e25a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t serialport_getLastString </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>anArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>maxLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function gives you all received data to the next CR (carriage return) in string format. </p>
<p>To get the string, it is necessary that your array is big enough to hold all data to the CR. If is not (maxLength reached, before CR is) this function return 0 and data is lost. The maxLength means all chars in the string including 0x00, so it should equals the array length!</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*anArray</td><td>The pointer to the array assigned with the data. It have to be big enough to store all data received! </td></tr>
    <tr><td class="paramname">maxLength</td><td>The length of the array. Correct value is necessary to prevent array overflow.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The amount of characters stored in the array including the string end sign 0x00! If 0 is returned, no CR is received or the array is to small. </dd></dl>

</div>
</div>
<a class="anchor" id="a7d2ad1b66db9224eff7468cbafe4f9d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serialport_write </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>anArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>arrayLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function you send an array (string). </p>
<p>It uses 64 byte buffer. It is possible to overrun the buffer, don't send more than 64 bytes at one Time! Check the buffer space with the <a class="el" href="_serialport_8c.html#a48f486016e00b1593a7098dc9df8dbb5" title="This function check how many bytes are free in the transmit buffer. ">serialport_checkSpace()</a> function, before you use this function.<br/>
Sending is interrupt driven and don't stop the controller. The function uses only the arrayLength. String end (0x00) would not be recognized!</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*anArray</td><td>The pointer to the array with the data to send. </td></tr>
    <tr><td class="paramname">arrayLength</td><td>The number of bytes to send. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae032fbb13c4f1a7ecc1239dbf40f9258"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serialport_writeCarriage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_a_r_r_i_a_g_e.html">CARRIAGE</a> *&#160;</td>
          <td class="paramname"><em>aCARRIAGE</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function send a carriage as string in the carriage format. </p>
<p>It transform a carriage into a valid string and send it vie the <a class="el" href="_serialport_8c.html#a7d2ad1b66db9224eff7468cbafe4f9d0" title="This function you send an array (string). ">serialport_write()</a> function. It use <a class="el" href="_serialport_8c.html#a48f486016e00b1593a7098dc9df8dbb5" title="This function check how many bytes are free in the transmit buffer. ">serialport_checkSpace()</a> function too and wait for enough space if the buffer is full. So in every case all data are transmitted and buffer overflow is not possible. Be careful when you send many carriages successively because the function WAIT if the buffer is full and no other code is executed until all carriages are copied into transmit buffer!</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aCARRIAGE</td><td>The pointer to the carriage witch is transmitted. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Oct 16 2013 11:31:16 for ConFLiCT by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
